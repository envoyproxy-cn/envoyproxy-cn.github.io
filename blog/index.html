<!doctype html><html lang=zh class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.74.2"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=alternate type=application/rss+xml href=/blog/index.xml><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>博客 |</title><meta property="og:title" content="博客"><meta property="og:description" content="致力于Envoy在中国的发展"><meta property="og:type" content="website"><meta property="og:url" content="/blog/"><meta itemprop=name content="博客"><meta itemprop=description content="致力于Envoy在中国的发展"><meta name=twitter:card content="summary"><meta name=twitter:title content="博客"><meta name=twitter:description content="致力于Envoy在中国的发展"><link rel=preload href=/scss/main.min.e226c86e583aaf61ca1bcce636aaa0d0bbeebe95c29d67c149aa547ec23c4094.css as=style><link href=/scss/main.min.e226c86e583aaf61ca1bcce636aaa0d0bbeebe95c29d67c149aa547ec23c4094.css rel=stylesheet integrity><script src=/js/jquery-3.5.1.min.js></script><script src=/js/lunr.min.js></script></head><body class="td-section td-blog"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg width="200" height="269" viewBox="0 0 522 169" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Envoy_Logo_Final_PANTONE-REVERSE</title><desc>Created with Sketch.</desc><defs><polygon id="path-1" points="0 0.449 0 87.94 91.22 87.94 91.22 0.449"/><polygon id="path-3" points="0.695126691 0.484 191.856996 0.484 191.856996 163.037966 0.695126691 163.037966"/></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Envoy_Logo_Final_PANTONE-REVERSE"><path d="M294.535 85.529C294.463 83.366 294.12 81.383 293.507 79.579 292.895 77.777 291.975 76.21 290.75 74.875 289.522 73.541 287.991 72.494 286.152 71.738 284.313 70.981 282.167 70.601 279.716 70.601 277.337 70.601 275.155 71.052 273.172 71.953 271.187 72.857 269.511 74.028 268.141 75.469 266.771 76.912 265.708 78.517 264.95 80.283 264.193 82.051 263.815 83.799 263.815 85.529H294.535zM263.815 93.317C263.815 95.554 264.302 97.591 265.275 99.43 266.249 101.269 267.529 102.837 269.115 104.135 270.7 105.433 272.539 106.443 274.632 107.163 276.723 107.886 278.886 108.245 281.122 108.245 284.151 108.245 286.782 107.543 289.02 106.136 291.253 104.73 293.309 102.874 295.185 100.565L302.54 106.191C297.131 113.186 289.559 116.683 279.824 116.683 275.785 116.683 272.125 115.996 268.845 114.628 265.563 113.259 262.787 111.365 260.515 108.948 258.245 106.533 256.494 103.685 255.269 100.404 254.042 97.122 253.43 93.571 253.43 89.747 253.43 85.926 254.097 82.375 255.432 79.093 256.765 75.813 258.604 72.964 260.948 70.548 263.291 68.132 266.086 66.239 269.332 64.868 272.576 63.499 276.109 62.813 279.933 62.813 284.476 62.813 288.316 63.607 291.453 65.194 294.59 66.78 297.167 68.853 299.187 71.413 301.205 73.974 302.666 76.859 303.568 80.066 304.469 83.276 304.92 86.54 304.92 89.856V93.317H263.815z" id="Fill-1" fill="#fffffe"/><path d="M313.358 64.111H323.093V72.007H323.309C324.534 69.267 326.663 67.05 329.691 65.355 332.72 63.661 336.217 62.813 340.183 62.813 342.635 62.813 344.998 63.192 347.268 63.949 349.54 64.707 351.523 65.879 353.218 67.464 354.912 69.052 356.264 71.088 357.275 73.577 358.284 76.064 358.79 79.004 358.79 82.392V115.385H349.053V85.097C349.053 82.716 348.729 80.68 348.081 78.985 347.431 77.292 346.566 75.921 345.483 74.875 344.403 73.829 343.159 73.073 341.752 72.603 340.346 72.134 338.885 71.899 337.372 71.899 335.351 71.899 333.477 72.224 331.746 72.873S328.502 74.55 327.202 75.956C325.904 77.362 324.894 79.147 324.174 81.31 323.453 83.475 323.093 86.035 323.093 88.991V115.385H313.358V64.111" id="Fill-2" fill="#fffffe"/><polyline id="Fill-3" fill="#fffffe" points="361.925 64.111 373.176 64.111 388.537 103.378 403.248 64.111 413.632 64.111 393.513 115.385 382.804 115.385 361.925 64.111"/><path d="M424.668 89.747C424.668 92.345 425.063 94.742 425.857 96.941 426.65 99.143 427.768 101.016 429.211 102.567 430.652 104.117 432.418 105.344 434.511 106.244 436.602 107.147 438.946 107.596 441.542 107.596 444.138 107.596 446.481 107.147 448.573 106.244 450.664 105.344 452.43 104.117 453.873 102.567 455.315 101.016 456.432 99.143 457.227 96.941 458.02 94.742 458.417 92.345 458.417 89.747 458.417 87.151 458.02 84.755 457.227 82.555 456.432 80.356 455.315 78.481 453.873 76.929 452.43 75.38 450.664 74.155 448.573 73.251 446.481 72.351 444.138 71.899 441.542 71.899 438.946 71.899 436.602 72.351 434.511 73.251 432.418 74.155 430.652 75.38 429.211 76.929 427.768 78.481 426.65 80.356 425.857 82.555 425.063 84.755 424.668 87.151 424.668 89.747zM414.283 89.747C414.283 85.999 414.987 82.501 416.392 79.255 417.798 76.01 419.727 73.163 422.179 70.709 424.63 68.259 427.515 66.329 430.833 64.922 434.149 63.516 437.718 62.813 441.542 62.813 445.363 62.813 448.933 63.516 452.251 64.922 455.567 66.329 458.453 68.259 460.906 70.709 463.356 73.163 465.286 76.01 466.693 79.255 468.098 82.501 468.802 85.999 468.802 89.747 468.802 93.498 468.098 97.014 466.693 100.295 465.286 103.578 463.356 106.425 460.906 108.841 458.453 111.257 455.567 113.167 452.251 114.574 448.933 115.98 445.363 116.683 441.542 116.683 437.718 116.683 434.149 115.98 430.833 114.574 427.515 113.167 424.63 111.257 422.179 108.841 419.727 106.425 417.798 103.578 416.392 100.295 414.987 97.014 414.283 93.498 414.283 89.747z" id="Fill-4" fill="#fffffe"/><path d="M469.557 64.111h11.25L495.99 104.135H496.208L510.771 64.111H521.155L496.817 126.418C495.954 128.653 495.056 130.692 494.123 132.531 493.19 134.368 492.076 135.938 490.785 137.236 489.491 138.534 487.93 139.543 486.097 140.264 484.266 140.984 482.022 141.346 479.365 141.346 477.928 141.346 476.473 141.255 475.002 141.075 473.529 140.895 472.111 140.517 470.747 139.94L471.931 131.07C473.864 131.863 475.799 132.259 477.734 132.259 479.238 132.259 480.51 132.06 481.55 131.665 482.587 131.267 483.483 130.692 484.237 129.933 484.988 129.177 485.615 128.293 486.118 127.283 486.618 126.273 487.12 125.12 487.623 123.822L490.774 115.709 469.557 64.111" id="Fill-5" fill="#fffffe"/><polyline id="Fill-6" fill="#953984" points="56.279 81.853 56.601 95.448 70.917 104.324 70.596 90.72 56.279 81.853"/><g id="Group-10" transform="translate(0.000000, 81.000000)"><mask id="mask-2" fill="#fff"><use xlink:href="#path-1"/></mask><g id="Clip-8"/><path d="M91.22 57.357 90.907 44.042 78.361 36.268C78.175 36.152 78.01 36.016 77.829 35.894L78.146 49.254 91.22 57.357" id="Fill-7" fill="#953984" mask="url(#mask-2)"/><path d="M46.52 75.284 13.788 55.002 12.992 20.964 29.039 14.044 28.717.449 3.107 11.49C1.137 12.347-.047 14.154.001 16.262L.962 57.097C1.01 59.204 2.29 61.267 4.313 62.53L43.567 86.856C45.396 87.987 47.602 88.297 49.462 87.709 49.659 87.647 49.838 87.576 50.017 87.506L74.105 77.122 61.04 69.022 46.52 75.284" id="Fill-9" fill="#953984" mask="url(#mask-2)"/></g><path d="M152.283 81.075C152.223 78.627 150.736 76.202 148.374 74.744L100.716 45.207 99.245 45.842 99.582 60.134 137.32 83.514 138.222 121.754 152.655 130.698 153.442 130.358 152.283 81.075" id="Fill-11" fill="#ac6199"/><g id="Group-15" transform="translate(34.000000, 0.000000)"><mask id="mask-4" fill="#fff"><use xlink:href="#path-3"/></mask><g id="Clip-13"/><path d="M61.206 148.199 16.93 120.759 15.842 74.699 36.014 66.01 35.64 50.146 4.319 63.648C2.022 64.649.637 66.769.697 69.216L1.972 123.211C2.02 125.663 3.514 128.071 5.876 129.53L57.772 161.701C59.91 163.024 62.482 163.383 64.65 162.698 64.872 162.628 65.088 162.546 65.297 162.452L95.953 149.237 80.709 139.791 61.206 148.199" id="Fill-12" fill="#ac6199" mask="url(#mask-4)"/><path d="M118.133 137.748 60.302 101.911 58.88 41.761 115.291 17.448 173.116 53.272 174.538 113.422 118.133 137.748zM185.76 43.255 119.219 2.011C116.764.49 113.838.089 111.335.88 111.089.958 110.848 1.047 110.611 1.148L45.707 29.137C43.078 30.271 41.497 32.686 41.563 35.49L43.195 104.712C43.26 107.516 44.968 110.27 47.664 111.941L114.2 153.172C116.646 154.687 119.573 155.099 122.061 154.313 122.307 154.235 122.56 154.142 122.807 154.036L187.717 126.059C190.346 124.925 191.921 122.498 191.855 119.693L190.23 50.484C190.164 47.68 188.456 44.925 185.76 43.255z" id="Fill-14" fill="#c04589" mask="url(#mask-4)"/></g></g></g></svg></span><span class="text-uppercase font-weight-bold"></span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>文档</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/blog/><span class=active>博客</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/community/><span>社区</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002 站内搜索…" aria-label=站内搜索… autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002 站内搜索…" aria-label=站内搜索… autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/blog/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">博客</a></li><ul><li class="collapse show" id=blog><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/blog/code/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">源码分析</a></li><ul><li class=collapse id=blogcode><a class="td-sidebar-link td-sidebar-link__page" id=m-blog20200823envoye6ba90e7a081e58886e69e90e4b98bdispatchere69cbae588b6 href=/blog/2020/08/23/envoy%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bdispatcher%E6%9C%BA%E5%88%B6/>Envoy源码分析之Dispatcher机制</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20200823envoye6ba90e7a081e58886e69e90e4b98bthreadlocale69cbae588b6 href=/blog/2020/08/23/envoy%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bthreadlocal%E6%9C%BA%E5%88%B6/>Envoy源码分析之ThreadLocal机制</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-blog20200510e5a682e4bd95e4b8ba-envoy-e69e84e5bbbae4b880e4b8aae68ea7e588b6e99da2e69da5e7aea1e79086e99b86e7bea4e7bd91e7bb9ce6b581e9878f href=/blog/2020/05/10/%E5%A6%82%E4%BD%95%E4%B8%BA-envoy-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%A5%E7%AE%A1%E7%90%86%E9%9B%86%E7%BE%A4%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F/>如何为 Envoy 构建一个控制面来管理集群网络流量</a></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/envoyproxy-cn/envoyproxy-cn.io/edit/master/content/zh/blog/_index.md target=_blank><i class="fa fa-edit fa-fw"></i>编辑此页</a>
<a href="https://github.com/envoyproxy-cn/envoyproxy-cn.io/issues/new?title=%e5%8d%9a%e5%ae%a2" target=_blank><i class="fab fa-github fa-fw"></i>提交文档问题</a>
<a href=https://github.com/envoyproxy-cn/envoyproxy-cn.io/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i>提交项目问题</a></div></div><main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main><a class="btn btn-lg -bg-orange td-rss-button d-none d-lg-block" href=/blog/index.xml target=_blank>RSS <i class="fa fa-rss ml-2"></i></a><div class=row><div class=col-12><h2>Posts in 2020</h2><ul class="list-unstyled mt-4"><li class="media mb-4"><div class=media-body><h5 class="mt-0 mb-1"><a href=/blog/2020/08/23/envoy%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bthreadlocal%E6%9C%BA%E5%88%B6/>Envoy源码分析之ThreadLocal机制</a></h5><p class="mb-2 mb-md-3"><small class=text-muted>2020年8月23日 in 源码分析</small></p><p class="pt-0 mt-0">ThreadLocal机制 ​ Envoy中的ThreadLocal机制其实就是我们经常说的线程本地存储简称TLS(Thread Local Storage)，顾名思义通过TLS定义的变量会在每一个线程专有的存储区域存储一份，访问TLS的时候，其实访问的是当前线程占有存储区域中的副本，因此可以使得线程可以无锁的并发访问同一个变量。Linux上一般有三种方式来定义一个TLS变量。
gcc对C语言的扩展__thread pthread库提供的pthread_key_create C++11 …</p><p class=pt-0><a href=/blog/2020/08/23/envoy%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bthreadlocal%E6%9C%BA%E5%88%B6/>更多</a></p></div></li><li class="media mb-4"><div class=media-body><h5 class="mt-0 mb-1"><a href=/blog/2020/08/23/envoy%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bdispatcher%E6%9C%BA%E5%88%B6/>Envoy源码分析之Dispatcher机制</a></h5><p class="mb-2 mb-md-3"><small class=text-muted>2020年8月23日 in 源码分析</small></p><p class="pt-0 mt-0">Dispatcher机制 ​ Envoy和Nginx一样都是基于事件驱动的架构，这种架构的核心就是事件循环(EventLoop)。业界目前典型的几种事件循环实现主要有Libevent、Libev、Libuv、Boost.Asio等，也可以完全基于Linux系统调用epoll来实现。Envoy选择在Libevent的基础上进行了封装，实现了自己的事件循环机制，在Envoy中被称为Dispatcher，一个Dispatcher对象就是一个事件分发器，就如同它的名字一样。Dispatcher …</p><p class=pt-0><a href=/blog/2020/08/23/envoy%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bdispatcher%E6%9C%BA%E5%88%B6/>更多</a></p></div></li><li class="media mb-4"><div class=media-body><h5 class="mt-0 mb-1"><a href=/blog/2020/05/10/%E5%A6%82%E4%BD%95%E4%B8%BA-envoy-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%A5%E7%AE%A1%E7%90%86%E9%9B%86%E7%BE%A4%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F/>如何为 Envoy 构建一个控制面来管理集群网络流量</a></h5><p class="mb-2 mb-md-3"><small class=text-muted>2020年5月10日 in 博客</small></p><p class="pt-0 mt-0">前言 这篇文章我看了之后非常想翻译，为什么呢？一方面我也在学习 Envoy，并且在公司的实际项目中使用 Envoy，另一方面，我确实也在设计一个控制管理端来统一管控多个集群的所有流量，没错我说的是所有的流量管控。目前这个管理系统在内部已经在逐步使用起来了。所以翻译这篇文章，即学习 Envoy 技术，也是想做一个参考，印证我的想法是不是 OK 的，取长补短。
指导在服务边缘构建控制面来管理 Envoy Proxy，让它作为服务网关或者在服务网格中使用 Envoy 已经成为了一个非常流行的网络组件 …</p><p class=pt-0><a href=/blog/2020/05/10/%E5%A6%82%E4%BD%95%E4%B8%BA-envoy-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%A5%E7%AE%A1%E7%90%86%E9%9B%86%E7%BE%A4%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F/>更多</a></p></div></li></ul></div></div><div class="row pl-2 pt-2"><div class=col></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/envoyproxy-cn/envoyproxy-cn.io><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://envoyproxy.slack.com/archives/C018HMZH37F><i class="fab fa-slack"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2021 Envoy中文社区 All Rights Reserved <a href=https://beian.miit.gov.cn target=_blank>粤ICP备15029944号</a></small></div></div></div></footer></div><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/main.min.664f21bf5eb0c31ebc661e2616e6c63e0448cec6d5636d869957be423c3cb952.js integrity="sha256-Zk8hv16wwx68Zh4mFubGPgRIzsbVY22GmVe+Qjw8uVI=" crossorigin=anonymous></script></body></html>